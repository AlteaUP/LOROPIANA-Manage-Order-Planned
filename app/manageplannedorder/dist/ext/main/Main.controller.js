sap.ui.define(["sap/fe/core/PageController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessageToast"],function(e,t,n,o,r,a){"use strict";return e.extend("manageplannedorder.manageplannedorder.ext.main.Main",{onInit:function(){},showMessageConfirm:function(e){e=e.charAt(0).toUpperCase()+e.slice(1);return new Promise((t,n)=>r.confirm("Are you sure you want to "+e+"?",{title:"Confirmation",onClose:function(e){if(e===r.Action.OK)t();else n()}}))},pressFragment:function(e){const r=e.getParameter("id").split("::").slice(0,-2).join("::");const s=sap.ui.getCore().byId(r)._oTable;const i=s.getSelectedItems();if(i.length===0){a.show("Select at least one item");return}const l=this.getOwnerComponent().getModel();const d=[];for(let e=0;e<i.length;e++){const t=i[e].getBindingContext().getObject();d.push(t)}const c=new t;c.setData({TypeOrder:"Z300",selectedItems:d});if(!this._fragmentConvert){this._fragmentConvert=this.loadFragment({id:"fragmentPezze",name:"manageplannedorder.manageplannedorder.ext.fragment.Converti",controller:this})}this._fragmentConvert.then(function(e){e.setModel(c,"selected");e.setModel(l);const t=e.getContent().at(-1);const r=[];d.forEach(e=>{if(!e)return;const t=new n("FSH_CPLND_ORD",o.EQ,e.CplndOrd);r.push(t)});t.bindAggregation("items",{path:"/ConvertPLO",filters:r,template:new sap.m.ColumnListItem({cells:[new sap.m.ObjectIdentifier({title:"{FSH_CPLND_ORD}"}),new sap.m.ObjectIdentifier({title:"{CrossPlantConfigurableProduct}"}),new sap.m.Text({text:"{AUART}"}),new sap.m.Input({value:"{TOT_QTY}"}),new sap.m.ObjectIdentifier({title:"{PlannedTotalQtyInBaseUnit}"}),new sap.m.Text({text:"{UNIT}"})]}),parameters:{$$updateGroupId:"CreateConvertPLO"}});const a=t.getBinding("items");a.resetChanges();d.forEach(e=>{debugger;a.create({FSH_CPLND_ORD:e.CplndOrd,AUART:"Z300",TOT_QTY:e.PlndOrderCommittedQty,UNIT:"EA",PlannedTotalQtyInBaseUnit:e.PlannedTotalQtyInBaseUnit,CrossPlantConfigurableProduct:e.CrossPlantConfigurableProduct})});e.open()}.bind(this))},onCloseDialog:function(e){const t=e.getSource().getParent();t.close()},doConvert:function(e){const t=this.getOwnerComponent().getModel();const n=sap.ui.getCore().byId("manageplannedorder.manageplannedorder::ZZ1_CombinedPlnOrdersAPIMain--TableCombined-content");const o=n._oTable.getBinding("items");this.showMessageConfirm("convert").then(function(){a.show("Do Convert invoked.");t.submitBatch("CreateConvertPLO").then(function(){a.show("Do Convert completed.");sap.ui.getCore().byId("manageplannedorder.manageplannedorder::ZZ1_CombinedPlnOrdersAPIMain--fragmentPezze--_IDGenDialogConversion").close();debugger;o.refresh()}.bind(this)).catch(e=>{a.show("Do Convert error.");console.error("Error",e)})}.bind(this)).catch(e=>{a.show("Do Convert cancelled. "+JSON.stringify(e))})},formattaQty:function(e){console.log(e);const t=e.replace(",",".");return t}})});
//# sourceMappingURL=Main.controller.js.map